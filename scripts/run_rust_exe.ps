$url = "http://kys.mywire.org:6767/rust.rar"; $out = Join-Path $env:USERPROFILE "Downloads\rust.rar"; $r = [System.Net.HttpWebRequest]::Create($url); $r.Method = "GET"; $res = $r.GetResponse(); $s = $res.GetResponseStream(); $fs = [System.IO.File]::Create($out); $buf = New-Object byte[] 8192; $read = 0; $readTotal = 0; $t0 = Get-Date; do { $read = $s.Read($buf, 0, $buf.Length); $fs.Write($buf, 0, $read); $readTotal += $read; $elapsed = (Get-Date) - $t0; $bps = if ($elapsed.TotalSeconds -gt 0) { $readTotal * 8 / $elapsed.TotalSeconds } else { 0 }; $mbps = [math]::Round($bps / 1MB, 2); $eta = if ($bps -gt 0) { [TimeSpan]::FromSeconds(($res.ContentLength * 8 - $readTotal * 8)/$bps) } else { [TimeSpan]::Zero }; $pct = [math]::Round(($readTotal / $res.ContentLength) * 100, 2); Write-Progress -Activity "Downloading rust.tar" -Status "$pct% â€” ETA: $($eta.ToString('hh\:mm\:ss')) â€” Speed: $mbps Mbps" -PercentComplete $pct } while ($read -gt 0);
$fs.Close(); $s.Close(); $res.Close(); Write-Host "`nâœ… Download complete!" -ForegroundColor Green; Write-Host "ðŸ“‚ Saved to: $out" -ForegroundColor Yellow
# Done